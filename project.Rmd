---
title: "STA 325 Project"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
library(tidyr)
library(e1071)
library(tidyverse)
```

```{r}
UFC <- read.csv("data/preprocessed_data.csv")
```

```{r preprocessing}
UFC <- UFC %>% 
  mutate(win = ifelse(Winner == "Red", 1, 0)) 
UFC.new <- UFC%>% 
  mutate(winstreakdif = R_longest_win_streak - B_longest_win_streak) %>% 
  mutate(windif = R_wins - B_wins) %>% 
  mutate(R_win_percent = R_wins/(R_wins + R_losses + R_draw)) %>% 
  mutate(B_win_percent = B_wins/(B_wins + B_losses + B_draw)) %>% 
  mutate(winpercdif = R_win_percent - B_win_percent) %>% 
  mutate(heightdif = R_Height_cms - B_Height_cms) %>% 
  mutate(reachdif = R_Reach_cms - B_Reach_cms) %>% 
  mutate(weightdif = R_Weight_lbs - B_Weight_lbs) %>% 
  mutate(agedif = R_age - B_age) %>% 
  mutate(avg_SIG_STR_pctdif = R_avg_SIG_STR_pct - B_avg_SIG_STR_pct)
```

```{r}
UFC %>%
  head()
```

```{r}
UFC <- UFC %>%
  mutate(Winner = as.factor(Winner))
```

```{r}
set.seed(123)
smp_size <- floor(0.01 * nrow(UFC))
train_ind <- sample(seq_len(nrow(UFC)), size = smp_size)
train <- UFC[train_ind, ]
test <- UFC[-train_ind, ]
```

```{r}
train
```

```{r}
svmfit <- svm(Winner ~ ., data = train, kernel = "linear",
              cost = 1, scale=FALSE)
```

```{r}
ypred <- predict(svmfit, test)
length(ypred[test$Winner==ypred]) / length(ypred)
```

```{r}
svmfit <- svm(Winner ~ ., data = train, kernel = "radial",
              gamma = 1, cost = 1, scale=FALSE)
```

```{r}
ypred <- predict(svmfit, test)
length(ypred[test$Winner==ypred]) / length(ypred)
```


```{r}
set.seed(123)
smp_size <- floor(0.5 * nrow(UFC))
train_ind <- sample(seq_len(nrow(UFC)), size = smp_size)
train <- UFC[train_ind, ]
test <- UFC[-train_ind, ]
```

```{r}
lmfit <- glm(win ~ . -Winner, data = train, family="binomial")
summary(lmfit)
```


```{r}
pred <- predict(lmfit, test, type = "response")
ypred <- ifelse(pred > 0.5, 1, 0)
length(ypred[test$win==ypred]) / length(ypred)
```

```{r}
library(randomForest)
```

```{r}
rf.UFC <- randomForest(Winner~.-win, data = train, 
                          mtry = 6, importance = TRUE)
```

```{r}
imp <- importance(rf.UFC)
#imp
imp[order(imp[,"MeanDecreaseAccuracy"], decreasing=TRUE),]
```

```{r}
imp[order(imp[,"MeanDecreaseGini"], decreasing=TRUE),]
```
