---
title: "STA 325 Project"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
library(tidyr)
library(e1071)
library(tidyverse)
```

```{r}
UFC <- read.csv("data/preprocessed_data.csv")
```

```{r}
UFC <- UFC %>%
  mutate(win = ifelse(Winner == "Red", 1, 0))
```

```{r}
UFC %>%
  head()
```

```{r}
UFC <- UFC %>%
  mutate(Winner = as.factor(Winner))
```

```{r}
set.seed(123)
smp_size <- floor(0.01 * nrow(UFC))
train_ind <- sample(seq_len(nrow(UFC)), size = smp_size)

train <- UFC[train_ind, ]
test <- UFC[-train_ind, ]
```

```{r}
train
```

```{r}
svmfit <- svm(Winner ~ ., data = train, kernel = "linear",
              cost = 1, scale=FALSE)
```

```{r}
ypred <- predict(svmfit, test)
length(ypred[test$Winner==ypred]) / length(ypred)
```

```{r}
svmfit <- svm(Winner ~ ., data = train, kernel = "radial",
              gamma = 1, cost = 1, scale=FALSE)
```

```{r}
ypred <- predict(svmfit, test)
length(ypred[test$Winner==ypred]) / length(ypred)
```


```{r}
set.seed(123)
smp_size <- floor(0.5 * nrow(UFC))
train_ind <- sample(seq_len(nrow(UFC)), size = smp_size)

train <- UFC[train_ind, ]
test <- UFC[-train_ind, ]
```

```{r}
lmfit <- glm(win ~ . -Winner, data = train, family="binomial")
summary(lmfit)
```


```{r}
pred <- predict(lmfit, test, type = "response")
ypred <- ifelse(pred > 0.5, 1, 0)
length(ypred[test$win==ypred]) / length(ypred)
```

```{r}
library(randomForest)
```

```{r}
rf.UFC <- randomForest(Winner~.-win, data = train, 
                          mtry = 6, importance = TRUE)
```

```{r}
imp <- importance(rf.UFC)
#imp
imp[order(imp[,"MeanDecreaseAccuracy"], decreasing=TRUE),]
```

```{r}
imp[order(imp[,"MeanDecreaseGini"], decreasing=TRUE),]
```